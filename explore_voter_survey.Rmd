---
title: "Are there no Libertarians"
output: html_notebook
---

load libararies and files


```{r message=FALSE, warning=FALSE}
library(tidyverse)
voter_18_raw <- read_csv("data/VOTER_Survey_April18_Release1.csv")
```

Massage the data
```{r message=FALSE, warning=FALSE}


voter_18<- gather(voter_18_raw,"question","answer",
                  -caseid,
                  -pid3_2018,
                  -race_2018,
                  -gender_2018,
                  -faminc_new_2018,
                  -regzip_2018,
                  -inputstate_2018
                  ) %>% as_tibble() %>%
  
  filter(!is.na(caseid)) %>% 
  filter(str_detect(question,"_2018")) %>% 
  filter(!is.na(answer)) %>% 
  distinct() %>% 
                  {.}
# make demographic variables factors
voter_18 <- voter_18 %>%
  mutate(regzip_2018 =as.character(regzip_2018)) %>% 
  mutate(gender_2018=as.factor(gender_2018)) %>% 
  mutate(race_2018=as.factor(race_2018)) %>% 
  mutate(faminc_new_2018=as.factor(faminc_new_2018)) %>% 
  mutate(pid3_2018=as.factor(pid3_2018)) %>% 
  rename(party_2018=pid3_2018) %>% 
  rename(state_2018=inputstate_2018) %>% 
  rename(income_2018=faminc_new_2018)
  
#map numbers to states
state_plus <- c(state.abb[1:8],"DC",state.abb[9:50])
voter_18$state_2018 <- factor(voter_18$state_2018)
levels(voter_18$state_2018) <- state_plus


levels(voter_18$gender_2018) <- c("Male","Female")
levels(voter_18$race_2018) <- c("White","Black","Hispanic",
                                "Asian","Native Amerian","Mixed",
                                "Other","Middle Eastern")

levels(voter_18$party_2018) <- c("Democrat","Republican","Independent",
                                "Other","Not Sure")


income_key<-read_csv("income_key.csv",col_types = "ff",trim_ws = TRUE)

voter_18 <- voter_18 %>% mutate(income_2018_000=income_2018)
levels(voter_18$income_2018_000)<-levels(income_key$Label)
voter_18

save(voter_18,file="data/voter_18.rdata")
```
Look at some of the demographics
```{r}

demographics <- voter_18 %>% 
  distinct(caseid,.keep_all = TRUE) %>% 
  select(-question,-answer)

demographics %>% group_by(gender_2018) %>%
  summarise(gender=n())

demographics %>%
  ggplot(aes(income_2018_000))+geom_bar()
```
