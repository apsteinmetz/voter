---
title: "Are there no Libertarians"
output: html_notebook
---

load libararies and files


```{r message=FALSE, warning=FALSE}
library(tidyverse)
voter_18_raw <- read_csv("data/VOTER_Survey_April18_Release1.csv")
```

Massage the data
```{r message=FALSE, warning=FALSE}


voter_18<- gather(voter_18_raw,"question","answer",
                  -caseid,
                  -pid3_2018,
                  -race_2018,
                  -gender_2018,
                  -faminc_new_2018,
                  -regzip_2018,
                  -inputstate_2018
                  ) %>% as_tibble() %>%
  
  filter(!is.na(caseid)) %>% 
  filter(str_detect(question,"_2018")) %>% 
  filter(!is.na(answer)) %>% 
  distinct() %>% 
                  {.}
# make demographic variables factors
voter_18 <- voter_18 %>%
  mutate(regzip_2018 %>% as.character(regzip_2018)) %>% 
  mutate(gender_2018=as.factor(gender_2018)) %>% 
  mutate(race_2018=as.factor(race_2018)) %>% 
  mutate(faminc_new_2018=as.factor(faminc_new_2018)) %>% 
  mutate(pid3_2018=as.factor(pid3_2018)) %>% 
  rename(party_2018=pid3_2018) %>% 
  rename(state_2018=inputstate_2018) %>% 
  rename(income_2018=faminc_new_2018)
  
#map numbers to states
state_plus <- c(state.abb[1:8],"DC",state.abb[9:50])
voter_18$state_2018 <- factor(voter_18$state_2018)
levels(voter_18$state_2018) <- state_plus


levels(voter_18$gender_2018) <- c("Male","Female")
levels(voter_18$race_2018) <- c("White","Black","Hispanic",
                                "Asian","Native Amerian","Mixed",
                                "Other","Middle Eastern")

levels(voter_18$party_2018) <- c("Democrat","Republican","Independent",
                                "Other","Not Sure")


income_key<-read_delim("income_key.csv",delim=";",col_types = "ff",trim_ws = TRUE)

voter_18 <- voter_18 %>% mutate(income_2018_000income_key$Label)

save(voter_18,file="data/voter_18.rdata")
```

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
```{r}
income_l=levels(voter_18$income_2018) %>% 
         as.numeric()*10000+10000

income_r=levels(voter_18$income_2018) %>% 
         as.numeric()*10000+19999
income_r[income_r>100000]<-income_r[income_r>100000]+10000
```

